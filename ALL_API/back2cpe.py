# data = [
#   {
#     "index": 1,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.0",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 99.05
#   },
#   {
#     "index": 2,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.0.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.61
#   },
#   {
#     "index": 3,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.0.3",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.56
#   },
#   {
#     "index": 4,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.0.2",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.55
#   },
#   {
#     "index": 5,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.0.5",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.53
#   },
#   {
#     "index": 6,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.2.6",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.53
#   },
#   {
#     "index": 7,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.0.4",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.5
#   },
#   {
#     "index": 8,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.2.5",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.42
#   },
#   {
#     "index": 9,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.1.2",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.34
#   },
#   {
#     "index": 10,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.1.3",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.33
#   },
#   {
#     "index": 11,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.1.5",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.32
#   },
#   {
#     "index": 12,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.2.8",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.32
#   },
#   {
#     "index": 13,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.2.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.26
#   },
#   {
#     "index": 14,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.2.2",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.26
#   },
#   {
#     "index": 15,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.2.4",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.26
#   },
#   {
#     "index": 16,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.1.4",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.25
#   },
#   {
#     "index": 17,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 98.03
#   },
#   {
#     "index": 18,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "6.1.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.87
#   },
#   {
#     "index": 19,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "7.0.6",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.74
#   },
#   {
#     "index": 20,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.6",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.66
#   },
#   {
#     "index": 21,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "8.0.6",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.52
#   },
#   {
#     "index": 22,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.6.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.49
#   },
#   {
#     "index": 23,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.0",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.47
#   },
#   {
#     "index": 24,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "5.0.6",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.32
#   },
#   {
#     "index": 25,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "15.6",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.22
#   },
#   {
#     "index": 26,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.5.2",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.17
#   },
#   {
#     "index": 27,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.3",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.12
#   },
#   {
#     "index": 28,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "1.0.0",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.07
#   },
#   {
#     "index": 29,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.2",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.07
#   },
#   {
#     "index": 30,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "3.0.0",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.03
#   },
#   {
#     "index": 31,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.4",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 97.02
#   },
#   {
#     "index": 32,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "1.0.0b1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.98
#   },
#   {
#     "index": 33,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "3.0.0b",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.93
#   },
#   {
#     "index": 34,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "2.0.0",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.91
#   },
#   {
#     "index": 35,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.5",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.9
#   },
#   {
#     "index": 36,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "1.0.0b2",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.89
#   },
#   {
#     "index": 37,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "17.0",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.88
#   },
#   {
#     "index": 38,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.4.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.84
#   },
#   {
#     "index": 39,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "3.0.5",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.82
#   },
#   {
#     "index": 40,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "12.0.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.81
#   },
#   {
#     "index": 41,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "13.0.5",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.81
#   },
#   {
#     "index": 42,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "1.0.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.8
#   },
#   {
#     "index": 43,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "3.0.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.8
#   },
#   {
#     "index": 44,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "8.0",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.8
#   },
#   {
#     "index": 45,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "16.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.78
#   },
#   {
#     "index": 46,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "13.0.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.76
#   },
#   {
#     "index": 47,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "7.0.4",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.75
#   },
#   {
#     "index": 48,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "7.0.3",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.74
#   },
#   {
#     "index": 49,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "2.0.1",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.73
#   },
#   {
#     "index": 50,
#     "part": "a",
#     "vendor": "apple",
#     "product": "safari",
#     "version": "1.2.5",
#     "update": "",
#     "edition": "",
#     "language": "",
#     "score": 96.72
#   }
# ]
#
# # 创建一个空字典
# cpe_score_dict = {}
#
# # 遍历数据并构建 CPE 字符串和对应的得分
# cpe_list = []
# for entry in data:
#     cpe = f"cpe:/a:{entry['vendor']}:{entry['product']}:{entry['version']}:*:*:*"
#     cpe_score_dict[cpe] = entry["score"]
#     cpe_list.append(cpe)
#
# print(cpe_list)
#
# api_key = "sk-KJziv58j8TxW2j895f53B46408E04311Ac4121FcCa8f98Eb"  # 替换为你的 OpenAI API 密钥
#
#
#
# # 排序函数，按照 version 字段的数字升序排序
#
# import json
#
#
# # class CPESearchResult(BaseModel):
# #   index: int
# #   part: str
# #   vendor: str
# #   product: str
# #   version: str
# #   update: str
# #   edition: str
# #   language: str
# #   score: float
# # 自定义版本号排序的 key 函数
# def version_key(version):
#   # 定义字母的排序顺序，字母按照某个优先级排序
#   alpha_order = {'a': -1, 'b': 0, 'rc': 1, '': 2}  # 空字符串为空版本，优先级最后
#
#   # 将版本号拆分为多个部分
#   version_parts = version.split('.')
#
#   # 用于存储拆解后的版本号部分
#   version_parts_as_numbers = []
#
#   for part in version_parts:
#     # 处理版本号部分，如果部分是纯数字，则转换为整数
#     # 如果包含字母，则按字母的优先级排序
#     if part.isdigit():
#       version_parts_as_numbers.append(int(part))
#     else:
#       # 如果是带字母的版本号（例如 1.0.0b1），需要将字母映射到排序规则
#       # 先提取字母（如果有）
#       number_part = ''.join([char for char in part if char.isdigit()])
#       letter_part = ''.join([char for char in part if not char.isdigit()])
#       # 将数字部分转换为整数
#       version_parts_as_numbers.append(int(number_part))
#       # 将字母部分转换为对应的优先级
#       version_parts_as_numbers.append(alpha_order.get(letter_part, 2))  # 默认字母为空字符串
#
#   return version_parts_as_numbers
#
#
# # 按照版本号排序
# sorted_data = sorted(data, key=lambda x: version_key(x["version"]))
#
# # 打印排序后的结果
# print(json.dumps(sorted_data, indent=2))


from pydantic import BaseModel
from typing import List


# 定义 CPESearchResult 类
class CPESearchResult(BaseModel):
  index: int
  part: str
  vendor: str
  product: str
  version: str
  update: str
  edition: str
  language: str
  score: float


# version_key 函数定义
def version_key(version):
  # 定义字母的排序顺序，字母按照某个优先级排序
  alpha_order = {'a': -1, 'b': 0, 'rc': 1, '': 2}  # 空字符串为空版本，优先级最后

  # 将版本号拆分为多个部分
  version_parts = version.split('.')

  # 用于存储拆解后的版本号部分
  version_parts_as_numbers = []

  for part in version_parts:
    # 处理版本号部分，如果部分是纯数字，则转换为整数
    if part.isdigit():
      version_parts_as_numbers.append(int(part))
    else:
      # 如果是带字母的版本号（例如 1.0.0b1），需要将字母映射到排序规则
      number_part = ''.join([char for char in part if char.isdigit()])
      letter_part = ''.join([char for char in part if not char.isdigit()])

      # 将数字部分转换为整数
      version_parts_as_numbers.append(int(number_part))
      # 将字母部分转换为对应的优先级
      version_parts_as_numbers.append(alpha_order.get(letter_part, 2))  # 默认字母为空字符串

  return version_parts_as_numbers


# 示例数据
all_results = [
  CPESearchResult(index=1, part="a", vendor="apple", product="safari", version="1.0.0b1", update="", edition="",
                  language="", score=96.5),
  CPESearchResult(index=2, part="a", vendor="apple", product="safari", version="3.0.0b", update="", edition="",
                  language="", score=97.0),
  CPESearchResult(index=3, part="a", vendor="apple", product="safari", version="2.0.0", update="", edition="",
                  language="", score=94.5),
  CPESearchResult(index=4, part="a", vendor="apple", product="safari", version="1.0.0", update="", edition="",
                  language="", score=95.0)
]
print(all_results)
# 按照版本号排序
sorted_data = sorted(all_results, key=lambda x: version_key(x.version))

# 打印排序后的结果
import json

print(json.dumps([result.dict() for result in sorted_data], indent=2))

